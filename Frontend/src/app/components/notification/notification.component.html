<div class="notification-container">
  <!-- Floating Bell Button -->
  <button class="bell-btn" [class.shake]="(unreadCount$ | async)! > 0" (click)="togglePanel()">
    <i class="bi bi-bell-fill"></i>
    <span class="badge" *ngIf="(unreadCount$ | async) as count">{{ count > 99 ? '99+' : count }}</span>
    <div class="pulse-ring" *ngIf="(unreadCount$ | async)! > 0"></div>
  </button>

  <!-- Notification Panel -->
  <div class="notification-panel" [class.show]="isOpen">
    <div class="panel-header">
      <div class="header-title">
        <i class="bi bi-bell"></i>
        <span>Notifications</span>
      </div>
      <button class="mark-read-btn" (click)="markAllRead()" *ngIf="(unreadCount$ | async)! > 0">
        Mark all as read
      </button>
    </div>

    <div class="panel-body">
      <div class="empty-state" *ngIf="(notifications$ | async)?.length === 0">
        <i class="bi bi-bell-slash"></i>
        <p>No notifications yet</p>
      </div>

      <div class="notification-item" *ngFor="let item of notifications$ | async" [class.unread]="!item.IsRead">
        <div class="icon-wrapper" [ngClass]="{
                    'new-plan': item.Event_Type === 'NEW_PLAN',
                    'cancel-plan': item.Event_Type === 'CANCEL_PLAN'
                }">
          <i class="bi bi-file-earmark-plus" *ngIf="item.Event_Type === 'NEW_PLAN'"></i>
          <i class="bi bi-x-circle" *ngIf="item.Event_Type === 'CANCEL_PLAN'"></i>
          <i class="bi bi-info-circle" *ngIf="item.Event_Type !== 'NEW_PLAN' && item.Event_Type !== 'CANCEL_PLAN'"></i>
        </div>
        <div class="content icon_content">
          <p class="message">{{ item.Message }}</p>
          <span class="time">{{ item.Created_At | date:'dd/MM/yy HH:mm' }}</span>
        </div>
      </div>
    </div>
  </div>
</div>