<!-- เอาไว้แยกsidebarและตัวหน้า -->
<div class="layout">
  <!-- sidebarฝั่งuser -->
  <app-sidebar></app-sidebar>
  <!-- หน้าทั้งหมดไม่รวมsidebar -->
  <div class="content-area">
    <div class="header">
      <h4> Request </h4>
      <app-notification class="noti"></app-notification>

    </div>
    <p>Product Requisition </p>

    <!-- group รวม 2 row,button -->
    <div class="group-req ">
      <!-- row1+row2 -->
      <div class="input-req">
        <!-- row1 -->
        <div class="req-row1">
          <!-- รวม label,select ของ division,fac,phon,date -->
          <div class="group-select">
                <label for="division"> Division </label>
                <ng-select
                  [items]="Div"
                  bindLabel="label"
                  bindValue="value"
                  [ngModel]="Div_"
                  placeholder="Select Division">
                </ng-select>
              </div>


              <div class="group-select">
                <label for="Fac"> Fac </label>
                <ng-select
                  [items]="Fac"
                  bindLabel="label"
                  bindValue="value"
                  [ngModel]="Fac_"
                  placeholder="Select a Fac">
                </ng-select>
            </div>

          <div class="group-select">
            <label for="phonenumber"> Phone Number </label>
            <input type="tel" class="form-control" placeholder="Enter your phone number" id="phonenumber" [(ngModel)]="phone_"/>
          </div>

          <div class="group-select">
            <label for="date"> DueDate </label>
            <input type="date" class="form-control" placeholder="Enter date" id="date" [min]="today_" [(ngModel)]="DueDate_" />
          </div>

          <!-- select case -->
          <div class="group-select" style="width: 180px;">
            <label for="case"> Case </label>
            <ng-select
              [items]="Case"
              bindLabel="label"
              bindValue="value"
              [(ngModel)]="Case_"
              (change)="onTypechange()"
              placeholder="Select a case">
            </ng-select>
          </div>
        </div>
        <!--div row1-->
        <!-- row2 label,select case,Spec,Process,Machine No,QTY-->
        <div class="req-row2">
          <!-- group รวม label,select -->
          <div class="group-select">

            <label for="case"> Part No. </label>
            <ng-select
              [items]="PartNo"
              bindLabel="PartNo"
              [(ngModel)]="PartNo_"
              [virtualScroll]="true"
              (ngModelChange)="get_SPEC($event)"
              placeholder="Select  partNo">
            </ng-select>
          </div>
          <div class="group-select">
                <label for="spec"> Spec </label>
                <ng-select
                  [items]="spec"
                  bindLabel="SPEC"
                  [ngModel]="Spec_"
                  [virtualScroll]="true"
                  (ngModelChange)="get_Process($event)"
                  placeholder="Select Spec">
                </ng-select>


              </div>

          <div class="group-select">
            <label for="process"> Process </label>
            <ng-select
              [items]="Process"
              bindLabel="Process"
              [(ngModel)]="Process_"
              (ngModelChange)="get_MC($event)"
              placeholder="Select process">
            </ng-select>
          </div>

          <div class="group-select">
            <label for="Machine No"> Machine Type </label>
            <ng-select
              [items]="MachineType"
              bindLabel="MC"
              [(ngModel)]="MachineType_"
              placeholder="Select MachineType">
            </ng-select>
          </div>

        </div>
        <!--div row2-->

      </div>
      <!--div input-req-->
      <!-- btn group -->
      <div class="btn-group-req">
        <button class="btn-viewall" type="button" (click)="Clearall()"> CLEARALL <i class="bi bi-list"></i></button>
        <button class="btn-import" type="button" data-bs-toggle="modal" data-bs-target="#exampleModal"
          data-bs-whatever="@getbootstrap"> IMPORT <i class="bi bi-download"></i></button>
        <button class="btn-view" type="button" > VIEW <i class="bi bi-eye-fill"></i></button>

      </div>

    </div>
    <!--div grop-req-->
    <!-- table setup-->
    <div class="table-responsive">

      <table *ngIf="selectedType === 'setup'" class="table table-bordered text-center">
        <thead>
          <tr>
            <th>#</th>
            <th>Part No.</th>
            <th>Item No.</th>
            <th>Spec</th>
            <th>Process</th>
            <th>Machine Type</th>
            <th>Machine No.</th>
            <th>On Hand</th>
            <th>Usage</th>
            <th>QTY</th>
            <th>Case</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="items.length === 0">
            <td colspan="11" class="text-center text-muted">ยังไม่มีข้อมูล</td>
          </tr>
          <tr *ngFor="let item of items">
            <td><input type="checkbox"  [(ngModel)]="item.checked " ></td>
            <td>{{ item.partNo }}</td>
            <td>{{ item.itemNo }}</td>
            <td>{{ item.spec }}</td>
            <td>{{ item.process }}</td>
            <td>{{ item.machineType }}</td>
            <td>{{ item.machineNo }}</td>
            <td>{{ item.onHand }}</td>
            <td>{{ item.usage }}</td>
            <td><input class="yoyu" type="number" [(ngModel)]="item.qty"min="0"></td>
            <td>SET UP</td>
          </tr>
        </tbody>
      </table>
      <!-- <div *ngIf="items.length === 0 && isSearched" class="alert alert-warning mt-2">
        ไม่พบข้อมูล
      </div> -->
    </div>




    <!-- table other-->
    <div class="table-responsive">

      <table *ngIf="selectedType === 'other' && items.length > 0"class="table table-bordered text-center">
        <thead>
          <tr>
            <th>
              #
            </th>
            <th>Part No.</th>
            <th>Item No.</th>
            <th>Spec</th>
            <th>Process</th>
            <th>Machine Type</th>
            <th>Machine No.</th>
            <th>On Hand</th>
            <th>Usage</th>
            <th>QTY</th>
            <th>Case</th>

          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of items ">
            <td><input type="checkbox"  [(ngModel)]="item.checked " ></td>
            <td>{{ item.partNo }}</td>
            <td>{{ item.itemNo }}</td>
            <td>{{ item.spec }}</td>
            <td>{{ item.process }}</td>
            <td>{{ item.machineType }}</td>
            <td><input class="yoyu" type="text" [(ngModel)]="item.machineNoother" ></td>
            <td>{{ item.onHand }}</td>
            <td>{{ item.usage }}</td>
            <td><input class="yoyu" type="number"  [(ngModel)]="item.qty"min="0" ></td>
            <td>
             <ng-select
              [items]="Caseother"
              bindLabel="viewCase"
              bindValue="Case"
              [(ngModel)]="item.selectCaseother"
              [appendTo]="'body'"
              placeholder="Select a case">
            </ng-select>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- <div *ngIf="items.length === 0 && isSearched" class="alert alert-warning mt-2">
        ไม่พบข้อมูล
      </div> -->
    </div>






    <button class="btn-sendrequest" type="button"  ><i class="bi bi-cart-plus"></i> Add To Cart</button>
  </div>
  <!--div box-main-->
</div>
<!--div request-layout-->

<!-- test Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Upload File</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="fileInput" class="form-label">Choose Excel File:</label>
            <input type="file"
                   class="form-control"
                   id="fileInput"
                   accept=".xlsx, .xls"
                   (change)="onFileChosen($event)">
          </div>

          <div class="mb-3">
            <label for="message-text" class="col-form-label">Message:</label>
            <textarea class="form-control" id="message-text"></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Send File</button>
      </div>
    </div>
  </div>
</div>
