<div class="layout">

    <app-sidebarpurchase></app-sidebarpurchase>

    <div class="content-area">

        <h3 class="mb-4 fw-bold text-dark">Upload Master</h3>

        <!-- Navigation Buttons -->
        <div class="d-flex justify-content-center gap-4 mb-5 flex-shrink-0">
            <button class="btn btn-primary nav-btn" [class.active]="currentTab === 'purchase'"
                (click)="setTab('purchase')">
                Purchase Master
            </button>
            <button class="btn btn-primary nav-btn" [class.active]="currentTab === 'setup'" (click)="setTab('setup')">
                Setup Tool
            </button>
            <button class="btn btn-primary nav-btn" [class.active]="currentTab === 'cutting'"
                (click)="setTab('cutting')">
                Cutting Tool
            </button>
            <button class="btn btn-primary nav-btn" [class.active]="currentTab === 'typeTooling'"
                (click)="setTab('typeTooling')">
                Type Tooling
            </button>
            <button class="btn btn-primary nav-btn" [class.active]="currentTab === 'masterTooling'"
                (click)="setTab('masterTooling')">
                Master Tooling
            </button>
        </div>

        <!-- Content Area -->
        <div class="flex-grow-1 d-flex flex-column" style="min-height: 0;">

            <!-- PURCHASE MASTER TAB -->
            <div *ngIf="currentTab === 'purchase'">
                <h5 class="fw-bold mb-4">Upload Master Purchase</h5>

                <div class="row mb-5 justify-content-center">
                    <div class="col-md-8">
                        <!-- PMC File -->
                        <div class="d-flex align-items-center mb-4">
                            <input type="file" #fileInputPMC style="display: none;" (change)="onFileChangePMC($event)"
                                accept=".xlsx, .xls" />
                            <button class="btn btn-success btn-custom-green me-3" (click)="fileInputPMC.click()">
                                Select file PMC
                            </button>
                            <input type="text" class="form-control" placeholder="No files" readonly
                                [value]="pmcFileName">
                        </div>

                        <!-- GM File -->
                        <div class="d-flex align-items-center mb-4">
                            <input type="file" #fileInputGM style="display: none;" (change)="onFileChangeGM($event)"
                                accept=".xlsx, .xls" />
                            <button class="btn btn-success btn-custom-green me-3" (click)="fileInputGM.click()">
                                Select file GM
                            </button>
                            <input type="text" class="form-control" placeholder="No files" readonly
                                [value]="gmFileName">
                        </div>

                        <!-- IReport File (New) -->
                        <div class="d-flex align-items-center">
                            <input type="file" #fileInputIReport style="display: none;"
                                (change)="onFileChangeIReport($event)" accept=".xlsx, .xls" />
                            <button class="btn btn-success btn-custom-green me-3" (click)="fileInputIReport.click()">
                                Select file IReport
                            </button>
                            <input type="text" class="form-control" placeholder="No files" readonly
                                [value]="iReportFileName">
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-end gap-3 mt-5">
                    <button class="btn btn-success btn-custom-green" (click)="exportTemplate('purchase')">
                        Export file
                    </button>
                    <button class="btn btn-success btn-custom-green" (click)="uploadData('purchase')">
                        <i class="bi bi-upload me-2"></i> Upload Master
                    </button>
                </div>
            </div>

            <!-- SETUP TOOL TAB -->
            <div *ngIf="currentTab === 'setup'">
                <h5 class="fw-bold mb-4">Upload Master Setup Tool</h5>

                <div class="d-flex align-items-center mb-4" style="max-width: 600px;">
                    <input type="file" #fileInputSetup style="display: none;" (change)="onFileChangeSetup($event)"
                        accept=".xlsx, .xls" />
                    <button class="btn btn-success btn-custom-green me-3" (click)="fileInputSetup.click()">
                        Select file
                    </button>
                    <input type="text" class="form-control bg-light" placeholder="No files" readonly
                        [value]="setupFileName">
                </div>

                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label">Part No.</label>
                        <input type="text" class="form-control" [(ngModel)]="setupForm.partNo">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">DwgNo</label>
                        <input type="text" class="form-control" [(ngModel)]="setupForm.dwgNo">
                    </div>
                    <div class="col-md-2 d-flex align-items-end justify-content-end w-100">
                        <!-- Action buttons moved to side or keeping typical flow? 
                              Design shows buttons on Right side distinct from form. 
                              I'll use a float or flex behavior similar to design.
                         -->
                    </div>
                </div>

                <!-- Use a grid that leaves space on the right for buttons if needed, or put buttons at bottom properly -->
                <div class="row">
                    <div class="col-8">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Item No.</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.itemNo">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">DwgRev</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.dwgRev">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Item name</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.itemName">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">DwgUpdate</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.dwgUpdate">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Spec</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.spec">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Usag</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.usag">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Process</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.process">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">CT_sec</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.ctSec">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">MC</label>
                                <input type="text" class="form-control" [(ngModel)]="setupForm.mc">
                            </div>
                        </div>
                    </div>
                    <div class="col-4 d-flex flex-column align-items-end gap-4">
                        <button class="btn btn-success btn-custom-green w-50" (click)="exportTemplate('setup')">
                            Export file
                        </button>
                        <button class="btn btn-success btn-custom-green w-50" (click)="uploadData('setup')">
                            <i class="bi bi-upload me-2"></i> Upload Master
                        </button>
                    </div>
                </div>
            </div>

            <!-- CUTTING TOOL TAB -->
            <div *ngIf="currentTab === 'cutting'">
                <h5 class="fw-bold mb-4">Upload Master Cutting Tool</h5>

                <div class="d-flex align-items-center mb-4" style="max-width: 600px;">
                    <input type="file" #fileInputCutting style="display: none;" (change)="onFileChangeCutting($event)"
                        accept=".xlsx, .xls" />
                    <button class="btn btn-success btn-custom-green me-3" (click)="fileInputCutting.click()">
                        Select file
                    </button>
                    <input type="text" class="form-control bg-light" placeholder="No files" readonly
                        [value]="cuttingFileName">
                </div>

                <div class="row">
                    <div class="col-8">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Part No.</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.partNo">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">DwgNo</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.dwgNo">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Item No.</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.itemNo">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">DwgRev</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.dwgRev">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Process</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.process">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">DwgUpdate</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.dwgUpdate">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">MC</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.mc">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">CT_sec</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.ctSec">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Usage pcs</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.usagePcs">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Position</label>
                                <input type="text" class="form-control" [(ngModel)]="cuttingForm.position">
                            </div>
                        </div>
                    </div>
                    <div class="col-4 d-flex flex-column align-items-end gap-4">
                        <button class="btn btn-success btn-custom-green w-50" (click)="exportTemplate('cutting')">
                            Export file
                        </button>
                        <button class="btn btn-success btn-custom-green w-50" (click)="uploadData('cutting')">
                            <i class="bi bi-upload me-2"></i> Upload Master
                        </button>
                    </div>
                </div>
            </div>

            <!-- TYPE TOOLING TAB -->
            <div *ngIf="currentTab === 'typeTooling'">
                <h5 class="fw-bold mb-4">Upload Master Type Tooling</h5>

                <div class="d-flex align-items-center mb-4" style="max-width: 600px;">
                    <input type="file" #fileInputTypeTooling style="display: none;"
                        (change)="onFileChangeTypeTooling($event)" accept=".xlsx, .xls" />
                    <button class="btn btn-success btn-custom-green me-3" (click)="fileInputTypeTooling.click()">
                        Select file
                    </button>
                    <input type="text" class="form-control bg-light" placeholder="No files" readonly
                        [value]="typeToolingFileName">
                </div>

                <div class="row">
                    <!-- Currently no form fields requested, just upload button as per description "press button select file Type Tooling" -->
                    <!-- But if we need to show preview or inputs later we can add here. For now keeping it simple as per request. -->
                    <div class="col-12 d-flex justify-content-end">
                        <button class="btn btn-success btn-custom-green" (click)="uploadData('typeTooling')">
                            <i class="bi bi-upload me-2"></i> Upload Master
                        </button>
                    </div>
                </div>
            </div>

            <!-- MASTER TOOLING TAB -->
            <div *ngIf="currentTab === 'masterTooling'">
                <h5 class="fw-bold mb-4">Upload Master Setup Tool, Cutting Tool</h5>

                <!-- PMC Section -->
                <div class="mb-5">
                    <h6 class="fw-bold mb-3">PMC Division</h6>
                    <div class="d-flex align-items-center mb-3" style="max-width: 600px;">
                        <input type="file" #fileInputMasterToolingPMC style="display: none;"
                            (change)="onFileChangeMasterToolingPMC($event)" accept=".xlsx, .xls" />
                        <button class="btn btn-success btn-custom-green me-3"
                            (click)="fileInputMasterToolingPMC.click()">
                            Select File PMC
                        </button>
                        <input type="text" class="form-control bg-light" placeholder="No file selected" readonly
                            [value]="masterToolingPMCFileName">
                    </div>
                    <div class="d-flex justify-content-end">
                        <button class="btn btn-success btn-custom-green" (click)="uploadData('masterTooling')"
                            [disabled]="!tempData.masterToolingPMC || tempData.masterToolingPMC.length === 0">
                            <i class="bi bi-upload me-2"></i> Upload PMC
                        </button>
                    </div>
                </div>

                <!-- GM Section (Placeholder) -->
                <div class="mb-5">
                    <h6 class="fw-bold mb-3">GM Division</h6>
                    <div class="d-flex align-items-center mb-3" style="max-width: 600px;">
                        <input type="file" #fileInputMasterToolingGM style="display: none;"
                            (change)="onFileChangeMasterToolingGM($event)" accept=".xlsx, .xls" />
                        <button class="btn btn-secondary me-3" (click)="fileInputMasterToolingGM.click()" disabled>
                            Select File GM
                        </button>
                        <input type="text" class="form-control bg-light" placeholder="Coming Soon" readonly
                            [value]="masterToolingGMFileName">
                    </div>
                    <div class="d-flex justify-content-end">
                        <button class="btn btn-secondary" disabled>
                            <i class="bi bi-upload me-2"></i> Upload GM (Coming Soon)
                        </button>
                    </div>
                </div>
            </div>

        </div>

        <!-- Optional: Keep existing table below purely for dev verification or future use, or conditionally hide -->
        <!-- For now, I will omit it to match the clean design requested, or I can put it in a separate section below if needed. The request "ทำโครงไว้ก่อนเพราะยังไม่ทำTeble" suggests Table is not the priority or might not be needed in this view yet. I'll remove it to ensure the UI looks exactly like the design first. -->

    </div>
</div>